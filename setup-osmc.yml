---
  - hosts: all
    remote_user: osmc

    vars:

      sshd_config: /etc/ssh/sshd_config
      system_user: osmc

    tasks:

    - name: Place my public ssh key
      authorized_key: user="{{ system_user }}" key="{{ lookup('file', './files/authorized_keys.myuser.pub') }}"
    - name: Disable password login
      become: yes
      replace: dest={{ sshd_config }} regexp="#PasswordAuthentication yes" replace="PasswordAuthentication no"
      notify:
        - restart sshd

    handlers:

    - name: restart sshd
      become: yes
      service: name=sshd state=restarted
