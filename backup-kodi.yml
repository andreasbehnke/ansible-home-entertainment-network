---
  - hosts: all
    remote_user: root
    vars:
      backup_folder: ../libreelec_backup

    tasks:
       - name: test if backup_folder exists
         local_action: stat path={{ backup_folder }}
         register: stat_backup_folder

       - name: make sure local backup folder is present
         local_action: shell git init {{ backup_folder }}
         when: stat_backup_folder.stat.exists == False

       - name: backup kodi configuration
         local_action: shell scp -r root@{{ inventory_hostname }}:/storage/.kodi {{ backup_folder }}/.kodi

       - name: backup cache configuration
         local_action: shell scp -r root@{{ inventory_hostname }}:/storage/.cache {{ backup_folder }}/.cache
